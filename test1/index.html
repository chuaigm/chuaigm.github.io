<!DOCTYPE html>
<html lang="zh">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>平台文件大小统计</title>
  <style>
    body {
      font-family: Arial, sans-serif;
      text-align: center;
      padding: 20px;
    }
    button {
      background-color: #FFCC99; /* 淡橙色 */
      padding: 10px 20px;
      border: none;
      font-size: 16px;
      cursor: pointer;
      border-radius: 5px;
    }
    button:hover {
      background-color: #FFB366; /* 淡橙色 hover */
    }
    #result {
      margin-top: 20px;
      text-align: left;
      font-size: 14px;
      white-space: pre-wrap;
    }
    .bar-container {
      width: 100%;
      height: 40px;
      margin: 10px 0;
      display: flex;
      align-items: center;
    }
    .platform-name {
      padding-right: 10px;
      font-weight: bold;
      min-width: 120px;
      text-align: left;
    }
    .bar {
      height: 100%;
      display: flex;
      align-items: center; /* 保证文字在柱状图中垂直居中 */
    }
    .size-text {
      font-size: 12px;
      color: #555;
      padding-left: 10px; /* 文字距离柱状图左边缘的间距 */
    }
    .total-size {
      font-size: 24px;
      font-weight: bold;
      color: #FF5733; /* 红色，醒目 */
      margin-bottom: 20px;
    }
  </style>
</head>
<body>

  <h1>选择文件上传</h1>
  <button id="chooseFileBtn">选择文件</button>

  <div id="result"></div>

  <script>
    // 监听按钮点击事件
    document.getElementById('chooseFileBtn').addEventListener('click', function() {
      // 创建文件选择器
      const input = document.createElement('input');
      input.type = 'file';
      input.multiple = true; // 允许选择多个文件
      input.accept = '.txt'; // 仅允许选择 .txt 文件

      // 当用户选择文件后
      input.addEventListener('change', handleFileSelect);
      input.click();
    });

    // 处理文件选择并解析 txt 文件
    function handleFileSelect(event) {
      const files = event.target.files;
      const platformData = {};

      // 遍历每个文件
      Array.from(files).forEach(file => {
        if (file.name.endsWith('.txt')) {
          const platformName = file.name.replace('.txt', ''); // 获取平台名称
          const reader = new FileReader();

          reader.onload = function(e) {
            const content = e.target.result;
            const lines = content.split('\n');
            let totalSize = 0;

            // 解析每行大小并计算总和
            lines.forEach(line => {
              const match = line.match(/.*\s\(\s*(\d+)\s*KB\s*\)/);
              if (match) {
                const size = parseInt(match[1], 10); // 获取文件大小（单位 KB）
                totalSize += size;
              }
            });

            // 存储平台数据
            platformData[platformName] = totalSize;

            // 在所有文件处理完成后显示结果
            displayResults(platformData);
          };

          reader.readAsText(file);
        }
      });
    }

    // 显示结果（柱状图形式）
    function displayResults(platformData) {
      let resultText = '';
      let totalSizeInKB = 0;

      // 获取所有平台的大小并按从大到小排序
      const sortedPlatforms = Object.keys(platformData).sort((a, b) => platformData[b] - platformData[a]);

      // 清空之前的结果
      const resultContainer = document.getElementById('result');
      resultContainer.innerHTML = '';

      // 计算总大小（单位 GB）
      Object.values(platformData).forEach(sizeInKB => totalSizeInKB += sizeInKB);
      const totalSizeInGB = (totalSizeInKB / 1024 / 1024).toFixed(2);

      // 创建并显示总大小
      const totalSizeElem = document.createElement('div');
      totalSizeElem.classList.add('total-size');
      totalSizeElem.textContent = `总大小: ${totalSizeInGB} GB`;
      resultContainer.appendChild(totalSizeElem);

      // 创建柱状图
      sortedPlatforms.forEach(platform => {
        const sizeInKB = platformData[platform];
        const sizeInGB = (sizeInKB / 1024 / 1024).toFixed(2); // 转换为 GB

        // 计算柱状图的宽度（最大宽度为 100%，对应最大平台的文件大小）
        const maxSize = Math.max(...Object.values(platformData)); // 获取最大平台文件大小
        const barWidth = (sizeInKB / maxSize) * 100; // 计算当前平台的柱状图宽度

        // 随机生成颜色
        const randomColor = getRandomColor();

        // 创建平台的柱状图
        const barContainer = document.createElement('div');
        barContainer.classList.add('bar-container');
        
        const platformNameElem = document.createElement('div');
        platformNameElem.classList.add('platform-name');
        platformNameElem.textContent = `${platform}:`;

        const barElem = document.createElement('div');
        barElem.classList.add('bar');
        barElem.style.width = `${barWidth}%`;
        barElem.style.backgroundColor = randomColor;

        const sizeTextElem = document.createElement('div');
        sizeTextElem.classList.add('size-text');
        sizeTextElem.textContent = `${sizeInGB} GB`;

        // 将大小文本放置在柱状图内，并左对齐
        barElem.appendChild(sizeTextElem);

        // 添加到容器中
        barContainer.appendChild(platformNameElem);
        barContainer.appendChild(barElem);

        resultContainer.appendChild(barContainer);
      });
    }

    // 随机生成浅色
    function getRandomColor() {
      const r = Math.floor(Math.random() * 56) + 200; // 红色分量（200到255之间）
      const g = Math.floor(Math.random() * 56) + 200; // 绿色分量（200到255之间）
      const b = Math.floor(Math.random() * 56) + 200; // 蓝色分量（200到255之间）

      return `rgb(${r}, ${g}, ${b})`;
    }
  </script>

</body>
</html>



<!--
  
使用html实现一个网页，网页中间有一个淡橙色的按钮，点击按钮后，可以让用户选择一个文件夹加载，此文件夹内，有若干 txt文件，
每个txt 的名字，为一个 platform 的名字，每个txt内，都类似于如下格式：

PC原人2	( 6434 KB)
阿猫阿狗	( 178051 KB)
爆笑三国志	( 10074 KB)
爆笑水浒传	( 19298 KB)
超级医生	( 10283 KB)
大富翁2	( 9153 KB)
大富翁3	( 144596 KB)
大航海时代1	( 8673 KB)
大航海时代2	( 7442 KB)

需要统计每个txt 内，每一行后面括号内的数值，每个数值代表一个文件所占空间大小，需要将这个platform 内所有文件大小进行加和，并得到这个platform所占的空间大小，以 GB 为单位。
最后，统计所有的platform 的大小，并按照从大到小排序，将每个平台名 和所占用大小，打印出来，最后打印总的大小


画出一个柱状图在网页展示
  
  
-->